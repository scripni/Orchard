@using Orchard;
@using Orchard.DisplayManagement.Descriptors;
@using Orchard.DesignerTools.Services;
@using System.Xml;

@{
    Script.Require("jQueryUI_Tabs").AtHead();
    Script.Require("jQueryUI_Resizable").AtHead();
    Script.Include("orchard-designertools-shapetracing.js").AtHead();
    Style.Include("orchard-designertools-shapetracing.css").AtHead();
    
    // Code Mirror
    Script.Include("CodeMirror/codemirror.js");
    Style.Include("CodeMirror/codemirror.css");
    Script.Include("CodeMirror/razor.js");
    Style.Include("CodeMirror/razor.css");
    Script.Include("CodeMirror/javascript.js");
    Style.Include("CodeMirror/javascript.css");
    Script.Include("CodeMirror/css.js");
    Style.Include("CodeMirror/css.css");
    Script.Include("CodeMirror/htmlmixed.js");
}

<script class="shape-tracing-wrapper shapeType-@Model.Metadata.Type shapeId-@Model.GetHashCode()" shape-id="@Model.GetHashCode()" title="@Model.Metadata.Type" ></script>@Display(Model.Metadata.ChildContent)<script class="shape-tracing-wrapper" end-of="@Model.GetHashCode()"></script>
    @{
        Layout.Zones["Tail"].Add(
            New.ShapeTracingMeta(
                ShapeType: Model.Metadata.Type, 
                Definition: Model._Definition, 
                DefinitionContent: Model._DefinitionContent, 
                DisplayType: Model.Metadata.DisplayType, 
                Position: Model.Metadata.Position, 
                PlacementSource: Model.Metadata.PlacementSource, 
                Dump: Model._Dump, 
                PlacementContent: Model.PlacementContent, 
                Alternates: Model.Metadata.Alternates, 
                Wrappers: Model.Metadata.Wrappers, 
                ChildContent: Model.Metadata.ChildContent,
                ShapeId: Model.GetHashCode()
        ));
    }
